"use strict";function init(){initEvents()}function initEvents(){indoorLevels.forEach(function(e,n){$(e).on("click",function(){showLevel(n+1)})}),allLevelsCtrl.addEventListener("click",function(){showAllLevels()}),sortByNameCtrl.addEventListener("click",function(){this.checked?($(spacesEl).removeClass("grouped-by-category"),spacesList.sort("list__link")):($(spacesEl).addClass("grouped-by-category"),spacesList.sort("category"))}),pins.forEach(function(e){var n=contentEl.querySelector('.content__item[data-space="'+e.getAttribute("data-space")+'"]');e.addEventListener("mouseenter",function(){isOpenContentArea||$(n).addClass("content__item--hover")}),e.addEventListener("mouseleave",function(){isOpenContentArea||$(n).removeClass("content__item--hover")}),e.addEventListener("click",function(t){t.preventDefault(),openContent(e.getAttribute("data-space")),$(n).removeClass("content__item--hover")})}),contentCloseCtrl.addEventListener("click",function(){closeContentArea()}),spaces.forEach(function(e){var n=e.parentNode,t=n.getAttribute("data-level"),s=n.getAttribute("data-space");e.addEventListener("click",function(e){e.preventDefault(),closeSearch(),showLevel(t),openContent(s)})}),openSearchCtrl.addEventListener("click",function(){openSearch()}),closeSearchCtrl.addEventListener("click",function(){closeSearch()})}function showLevel(e){if(isExpanded)return!1;selectedLevel=e,$(indoorLevelsEl).addClass("levels--selected-"+selectedLevel);var n=indoorLevels[selectedLevel-1];$(n).addClass("level--current"),onEndTransition(n,function(){$(indoorLevelsEl).addClass("levels--open"),showPins(),isExpanded=!0},"transform"),hideSurroundings(),showindoornav(),showLevelSpaces()}function showAllLevels(){if(isNavigating||!isExpanded)return!1;isExpanded=!1,$(indoorLevels[selectedLevel-1]).removeClass("level--current"),$(indoorLevelsEl).removeClass("levels--selected-"+selectedLevel),$(indoorLevelsEl).removeClass("levels--open"),removePins(),showSurroundings(),hideindoornav(),spacesList.filter(),isOpenContentArea&&closeContentArea()}function showLevelSpaces(){spacesList.filter(function(e){return e.values().level===selectedLevel.toString()})}function showPins(e){var e=e||indoorLevels[selectedLevel-1];$(e.querySelector(".level__pins")).addClass("level__pins--active")}function removePins(e){var e=e||indoorLevels[selectedLevel-1];$(e.querySelector(".level__pins")).removeClass("level__pins--active")}function showindoornav(){$(indoornav).removeClass("indoornav--hidden")}function hideindoornav(){$(indoornav).addClass("indoornav--hidden")}function showSurroundings(){indoorSurroundings.forEach(function(e){$(e).removeClass("surroundings--hidden")})}function hideSurroundings(){indoorSurroundings.forEach(function(e){$(e).addClass("surroundings--hidden")})}function navigate(e){if(isNavigating||!isExpanded||isOpenContentArea)return!1;isNavigating=!0;var n=selectedLevel,t=indoorLevels[n-1];if("Up"===e&&n>1)--selectedLevel;else{if(!("Down"===e&&n<indoorLevelsTotal))return isNavigating=!1,!1;++selectedLevel}$(t).addClass("level--moveOut"+e);var s=indoorLevels[selectedLevel-1];$(s).addClass("level--current"),onEndTransition(t,function(){$(t).removeClass("level--moveOut"+e),setTimeout(function(){$(t).removeClass("level--current")},60),$(indoorLevelsEl).removeClass("levels--selected-"+n),$(indoorLevelsEl).addClass("levels--selected-"+selectedLevel),showPins(),isNavigating=!1}),showLevelSpaces(),removePins(t)}function openContent(e){isOpenContentArea?(hideSpace(),spaceref=e,showSpace()):(spaceref=e,openContentArea());var n=spacesEl.querySelector("li.list__item--active");n&&$(n).removeClass("list__item--active"),$(spacesEl.querySelector('li[data-space="'+e+'"]')).addClass("list__item--active");var t=indoorLevels[selectedLevel-1].querySelector("svg > .map_space--selected");t&&$(t).removeClass("map_space--selected"),$('svg > .map_space[data-space="'+spaceref+'"]').addClass("map_space--selected")}function openContentArea(){isOpenContentArea=!0,showSpace(!0),$(contentCloseCtrl).removeClass("content__button--hidden"),$(indoor).addClass("indoor--content-open")}function showSpace(e){var n=document.querySelector(".content__item[data-space='"+spaceref+"']");$(n).addClass("content__item--current"),e&&onEndTransition(n,function(){$(contentEl).addClass("content--open")}),$(".pin[data-space='"+spaceref+"']").addClass("--active")}function closeContentArea(){$(contentEl).removeClass("content--open"),hideSpace(),$(contentCloseCtrl).addClass("content__button--hidden"),$(indoor).removeClass("indoor--content-open"),isOpenContentArea=!1}function hideSpace(){var e=contentEl.querySelector('.content__item[data-space="'+spaceref+'"]');$(e).removeClass("content__item--current"),$(indoorLevelsEl.querySelector('.pin[data-space="'+spaceref+'"]')).removeClass("--active");var n=spacesEl.querySelector("li.list__item--active");n&&$(n).removeClass("list__item--active");var t=indoorLevels[selectedLevel-1].querySelector("svg > .map_space--selected");t&&$(t).removeClass("map_space--selected")}function openSearch(){showAllLevels(),$(spacesListEl).addClass("spaces-list--open"),$(containerEl).addClass("container--overflow")}function closeSearch(){$(spacesListEl).removeClass("spaces-list--open"),$(containerEl).removeClass("container--overflow")}var prefix=function(){var e=window.getComputedStyle(document.documentElement,""),n=(Array.prototype.slice.call(e).join("").match(/-(moz|webkit|ms)-/)||""===e.OLink&&["","o"])[1];return{dom:"WebKit|Moz|MS|O".match(new RegExp("("+n+")","i"))[1],lowercase:n,css:"-"+n+"-",js:n[0].toUpperCase()+n.substr(1)}}(),support={transitions:Modernizr.csstransitions},transEndEventNames={WebkitTransition:"webkitTransitionEnd",MozTransition:"transitionend",OTransition:"oTransitionEnd",msTransition:"MSTransitionEnd",transition:"transitionend"},transEndEventName=transEndEventNames[Modernizr.prefixed("transition")],onEndTransition=function(e,n,t){var s=function e(s){if(support.transitions){if(s.target!=this||t&&s.propertyName!==t&&s.propertyName!==prefix.css+t)return;this.removeEventListener(transEndEventName,e)}n&&"function"==typeof n&&n.call(this)};support.transitions?e.addEventListener(transEndEventName,s):s()},indoor=document.querySelector(".indoor"),indoorLevelsEl=indoor.querySelector(".levels"),indoorLevels=[].slice.call(indoorLevelsEl.querySelectorAll(".level")),indoorLevelsTotal=indoorLevels.length,indoorSurroundings=[].slice.call(indoor.querySelectorAll(".surroundings")),selectedLevel=void 0,indoornav=document.querySelector(".indoornav"),allLevelsCtrl=document.querySelector(".azavea-header > .header"),pins=[].slice.call(indoorLevelsEl.querySelectorAll(".pin")),contentEl=document.querySelector(".content"),contentCloseCtrl=contentEl.querySelector("button.content__button"),isOpenContentArea=void 0,isNavigating=void 0,isExpanded=void 0,spacesListEl=document.getElementById("spaces-list"),spacesEl=spacesListEl.querySelector("ul.list"),spaces=[].slice.call(spacesEl.querySelectorAll(".list__item > a.list__link")),spaceref=void 0,sortByNameCtrl=document.querySelector("#sort-by-name"),spacesList=new List("spaces-list",{valueNames:["list__link",{data:["level"]},{data:["category"]}]}),openSearchCtrl=document.querySelector("button.open-search"),containerEl=document.querySelector(".container"),closeSearchCtrl=spacesListEl.querySelector("button.close-search");init();